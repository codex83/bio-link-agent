2025-12-04 19:27:41.247 | INFO     | utils.eligibility_parser:__init__:90 - Loading biomedical NER model: raynardj/ner-disease-ncbi-bionlp-bc5cdr-pubmed
2025-12-04 19:27:41.247 | INFO     | utils.eligibility_parser:__init__:91 - This may take a few minutes on first run (downloading model)...
Device set to use cpu
2025-12-04 19:27:42.446 | INFO     | utils.eligibility_parser:__init__:103 - Successfully loaded NER model: raynardj/ner-disease-ncbi-bionlp-bc5cdr-pubmed
2025-12-04 19:27:42.544 | DEBUG    | utils.eligibility_parser:extract_conditions:183 - NER extracted 10 unique conditions
2025-12-04 19:27:42.676 | DEBUG    | utils.eligibility_parser:extract_conditions:183 - NER extracted 4 unique conditions
2025-12-04 19:27:42.676 | INFO     | utils.eligibility_parser:__init__:90 - Loading biomedical NER model: raynardj/ner-disease-ncbi-bionlp-bc5cdr-pubmed
2025-12-04 19:27:42.676 | INFO     | utils.eligibility_parser:__init__:91 - This may take a few minutes on first run (downloading model)...
Device set to use cpu
2025-12-04 19:27:43.218 | INFO     | utils.eligibility_parser:__init__:103 - Successfully loaded NER model: raynardj/ner-disease-ncbi-bionlp-bc5cdr-pubmed
2025-12-04 19:27:43.218 | INFO     | utils.eligibility_parser:__init__:259 - Eligibility parser initialized
2025-12-04 19:27:43.370 | DEBUG    | utils.eligibility_parser:extract_conditions:183 - NER extracted 5 unique conditions
2025-12-04 19:27:43.370 | DEBUG    | utils.eligibility_parser:_extract_conditions:380 - NER extracted 5 conditions
2025-12-04 19:27:43.508 | DEBUG    | utils.eligibility_parser:extract_conditions:183 - NER extracted 22 unique conditions
2025-12-04 19:27:43.508 | DEBUG    | utils.eligibility_parser:_extract_conditions:380 - NER extracted 22 conditions
================================================================================
ELIGIBILITY PARSER: BEFORE vs AFTER COMPARISON
================================================================================

Comparing:
  BEFORE: Regex-based keyword matching
  AFTER:  NER-based entity recognition (BC5CDR model)
================================================================================

[1/4] Initializing NER model...
‚úì NER model loaded: raynardj/ner-disease-ncbi-bionlp-bc5cdr-pubmed

[2/4] Test Case 1: Sample Eligibility Criteria
--------------------------------------------------------------------------------
Sample Text:

    INCLUSION CRITERIA:
    1. Histologically confirmed non-small cell lung cancer (NSCLC), adenocarcinoma subtype, Stage IIIA
    2. Patients with glioblastoma multiforme (GBM), grade IV, previously...

BEFORE (Regex): 2 conditions extracted
  1. non-small cell lung cancer (NSCLC)
  2. autoimmune disease (e

AFTER (NER): 10 conditions extracted
  1. small cell lung cancer
  2. NSCLC
  3. adenocarcinoma
  4. glioblastoma multiforme
  5. Type 2 diabetes mellitus
  6. breast cancer
  7. chronic lymphocytic leukemia
  8. autoimmune disease
  9. rheumatoid arthritis
  10. lupus

üìä Comparison:
  - Regex found: 2 conditions
  - NER found: 10 conditions
  - Improvement: 8 more conditions

[3/4] Test Case 2: Real Trial Eligibility Criteria
--------------------------------------------------------------------------------
Trial: Binimetinib for People With Relapsed/Refractory BRAF Wild Type Hairy C...
Eligibility criteria length: 9137 characters
Preview: * INCLUSION CRITERIA:
* Histologically confirmed diagnosis of HCL or HCLv according to morphological and immunophenotypic criteria of World Health Organization (WHO) classification \[WHO, 2008 revised...

BEFORE (Regex): 6 conditions extracted
  1. a partial or complete bowel obstruction
  2. an allogeneic bone marrow or stem cell transplant
  3. Hepatitis B Virus (HBV) or Hepatitis C Virus (HCV)
  4. second malignancy requiring treatment other than minor resection of indolent
  5. ulcerative
  6. acute coronary syndromes (including myocardial infarction

AFTER (NER): 4 conditions extracted
  1. lymphoid neoplasm
  2. splenomegaly
  3. ukemia
  4. Leukemic

üìä Comparison:
  - Regex found: 6 conditions
  - NER found: 4 conditions
  - Improvement: -2 more conditions

‚ú® Conditions found ONLY by NER (4):
  ‚Ä¢ splenomegaly
  ‚Ä¢ ukemia
  ‚Ä¢ lymphoid neoplasm
  ‚Ä¢ Leukemic

‚ö† Conditions found ONLY by Regex (6):
  ‚Ä¢ a partial or complete bowel obstruction
  ‚Ä¢ an allogeneic bone marrow or stem cell transplant
  ‚Ä¢ second malignancy requiring treatment other than minor resection of indolent

[4/4] Test Case 3: Full EligibilityParser Integration
--------------------------------------------------------------------------------
Full Parsed Results:
  ‚úì Min Age: 18
  ‚úì Max Age: None
  ‚úì Sex: ALL
  ‚úì Inclusion Criteria Items: 29
  ‚úì Exclusion Criteria Items: 22
  ‚úì Conditions Extracted (NER): 5
  ‚úì Excluded Conditions (NER): 22
  ‚úì Lab Value Constraints: 4
  ‚úì Performance Status: None

  Sample Conditions (NER-extracted):
    ‚Ä¢ HCLv
    ‚Ä¢ lymphoid neoplasm
    ‚Ä¢ splenomegaly
    ‚Ä¢ ukemia
    ‚Ä¢ Leukemic

  Sample Excluded Conditions (NER-extracted):
    ‚Ä¢ hypersensitivity
    ‚Ä¢ illness
    ‚Ä¢ infection
    ‚Ä¢ cardiac disfunction
    ‚Ä¢ uncontrolled pulmonary infection

================================================================================
SUMMARY: KEY DIFFERENCES
================================================================================

BEFORE (Regex):
  ‚ùå Extracts too much text (includes surrounding words)
  ‚ùå Misses conditions not matching specific patterns
  ‚ùå Doesn't understand medical terminology context
  ‚ùå Can't handle abbreviations well (e.g., "NSCLC")
  ‚ùå No entity boundary detection

AFTER (NER):
  ‚úÖ Accurate entity boundaries (extracts complete condition names)
  ‚úÖ Understands medical terminology and context
  ‚úÖ Handles abbreviations (e.g., "NSCLC" ‚Üí "non-small cell lung cancer")
  ‚úÖ Trained on biomedical literature (BC5CDR, NCBI-disease)
  ‚úÖ Better at identifying disease entities in complex text
  ‚úÖ More conditions extracted with higher accuracy

Example:
  Text: "Histologically confirmed non-small cell lung cancer (NSCLC)"
  
  Regex: "non-small cell lung cancer (NSCLC), adenocarcinoma subtype"
         (extracts too much, includes trailing text)
  
  NER:   "non-small cell lung cancer", "NSCLC", "adenocarcinoma"
         (extracts precise entities)
    
================================================================================
